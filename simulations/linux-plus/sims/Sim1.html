<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sim 1: Partition</title>
    <link rel="stylesheet" href="../../../assets/style.css">
    <style>
        /* Sim-specific styles */
        .sim-top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        .info-btn {
            padding: 8px;
            background-color: var(--interactive-blue);
            border: none;
            border-radius: 5px;
            cursor: pointer;
            color: white;
            line-height: 0; /* Helps align SVG */
        }
        .info-btn:hover {
            background-color: var(--interactive-blue-hover);
        }
        .info-btn svg {
            width: 24px;
            height: 24px;
            fill: currentColor;
        }
        #sim1-content {
            font-size: 1.2em;
            font-family: monospace;
            background-color: var(--bg-dark-secondary);
            padding: 2rem;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }
        #sim1-content div {
            margin-bottom: 1.5em;
        }
        #sim1-content select {
            background: var(--bg-dark-tertiary);
            color: white;
            border: 1px solid var(--border-color);
            padding: 5px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 1em;
        }
    </style>
</head>
<body>

    <div class="sim-container">
        <div class="sim-top-bar">
            <a href="../index.html" class="back-btn">Back to Linux+ Menu</a>
            <button id="infoBtn" class="info-btn" title="Show Instructions">
                <svg viewBox="0 0 24 24"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </button>
        </div>

        <h3>Sim 1: Partition</h3>
        <p>Use the dropdowns to construct the correct commands to partition and format a new disk.</p>
        <div id="sim1-content">
            </div>
        
        <div class="sim-controls">
            <div></div>
            <div>
                <button class="sim-check-btn" id="checkBtn">Check Answer</button>
                <button class="sim-reset-btn" id="resetBtn">Reset Sim</button>
            </div>
        </div>
    </div>

    <div id="modal" class="modal">
        <div class="modal-content">
            <pre id="modal-body-content" style="white-space: pre-wrap; font-family: sans-serif;"></pre>
            <button class="modal-close-btn">Close</button>
        </div>
    </div>

    <script>
        // --- Shared Modal Logic ---
        const modal = document.getElementById("modal");
        const modalBody = document.getElementById("modal-body-content");
        function showModal(message, isCentered = false) {
            modalBody.textContent = message;
            modal.querySelector('.modal-content').classList.toggle('centered-text', isCentered);
            modal.style.display = "flex";
        }
        function closeModal() { modal.style.display = "none"; }
        modal.querySelector('.modal-close-btn').onclick = closeModal;
        modal.onclick = e => { if (e.target.id === 'modal') closeModal(); };

        // --- Sim-specific JavaScript ---
        const sim1 = {
            data: {
                info: `DRAG DROP\nA junior administrator has been tasked with creating a new 10 GB ext4 partition on the /dev/sdc disk.\nYou must create the partition and format it.\n\nINSTRUCTIONS\nDrag and drop the correct command snippets from the left to complete the partition creation and formatting process on the right.`
            },
            setup: function() {
                const container = document.getElementById('sim1-content');
                const commandOptions = ["sdb", "ext3", "mkdir", "secondary", "/dev/sdc", "lsblk", "gpt", "mklabel", "ext4", "parted", "mkpart", "/dev/sdc1", "primary", "/dev/dev1"].sort(() => Math.random() - 0.5);
                const placeholder = `<option value="" disabled selected>Select</option>`;
                const options = placeholder + commandOptions.map(opt => `<option value="${opt}">${opt}</option>`).join('');

                container.innerHTML = `
                    <div>parted -s <select>${options}</select> <select>${options}</select> gpt</div>
                    <div>parted -s <select>${options}</select> <select>${options}</select> <select>${options}</select> <select>${options}</select> 1Mb-10Gb</div>
                    <div>mkfs.<select>${options}</select> <select>${options}</select></div>
                `;
            },
            check: function() {
                const selects = document.querySelectorAll("#sim1-content select");
                const correctAnswers = ["/dev/sdc", "mklabel", "/dev/sdc", "mkpart", "primary", "ext4", "ext4", "/dev/sdc1"];
                let isCorrect = Array.from(selects).every((select, index) => select.value === correctAnswers[index]);
                
                showModal(isCorrect ? "Correct! You have successfully partitioned the disk." : "Incorrect. Please review your selections.");
            }
        };

        // Initialize the simulation when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            sim1.setup();
            document.getElementById('checkBtn').addEventListener('click', () => sim1.check());
            document.getElementById('resetBtn').addEventListener('click', () => sim1.setup());
            document.getElementById('infoBtn').onclick = () => {
                showModal(sim1.data.info);
            };
        });
    </script>
</body>
</html>