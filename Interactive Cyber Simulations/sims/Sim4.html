<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sim 4: Attacks</title>
    <!-- Link to the shared stylesheet -->
    <link rel="stylesheet" href="../assets/style.css">
    <style>
        /* Sim-specific styles */
        .sim-top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        .info-btn {
            padding: 8px;
            background-color: var(--interactive-blue);
            border: none;
            border-radius: 5px;
            cursor: pointer;
            color: white;
            line-height: 0;
        }
        .info-btn:hover {
            background-color: var(--interactive-blue-hover);
        }
        .info-btn svg {
            width: 24px;
            height: 24px;
            fill: currentColor;
        }
        .sim4-question-grid { 
            display: grid; 
            grid-template-columns: 2fr 1fr 1.5fr 1.5fr; 
            gap: 15px; 
            align-items: center; 
            margin-bottom: 15px; 
            border-bottom: 1px solid var(--border-color); 
            padding-bottom: 15px;
        }
        .sim4-question-grid:last-of-type { 
            border-bottom: none; 
        }
        .sim4-header-grid {
            font-weight: bold;
            color: var(--accent-green);
        }
        .sim4-question-grid select { 
            width: 100%; 
            background: var(--bg-dark-tertiary); 
            color: white; 
            border: 1px solid var(--border-color); 
            padding: 8px; 
            border-radius: 4px; 
        }
    </style>
</head>
<body>

    <div class="sim-container">
        <div class="sim-top-bar">
            <a href="../index.html" class="back-btn">Back to Menu</a>
            <button id="infoBtn" class="info-btn" title="Show Instructions">
                <svg viewBox="0 0 24 24"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </button>
        </div>

        <h3>Sim 4: Identify and Remediate Attacks</h3>
        <div id="sim4-questions-container">
            <!-- Questions will be dynamically inserted here by the script -->
        </div>
        <div class="sim-controls">
             <!-- Empty div for spacing -->
            <div></div>
            <div>
                <button class="sim-check-btn" id="checkBtn">Check Answer</button>
                <button class="sim-reset-btn" id="resetBtn">Reset Sim</button>
            </div>
        </div>
    </div>

    <!-- Universal Modal Container -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <div id="modal-body-content"></div>
            <button class="modal-close-btn" onclick="closeModal()">Close</button>
        </div>
    </div>

    <script>
        // --- Shared Modal Logic ---
        const modal = document.getElementById("modal");
        const modalBody = document.getElementById("modal-body-content");
        function showModal(content, isCentered = true) {
            modalBody.innerHTML = '';
            if (typeof content === 'string') {
                const p = document.createElement('p');
                p.style.whiteSpace = 'pre-wrap';
                p.textContent = content;
                modalBody.appendChild(p);
            } else {
                modalBody.appendChild(content);
            }
            modal.querySelector('.modal-content').classList.toggle('centered-text', isCentered);
            modal.style.display = "flex";
        }
        function closeModal() { modal.style.display = "none"; }
        modal.onclick = e => { if (e.target.id === 'modal') closeModal(); };

        // --- Sim-specific JavaScript ---
        const sim4 = {
            data: {
                info: "SIMULATION\nSelect the appropriate attack and remediation from each drop-down list to label the corresponding attack with its remediation.\n\nINSTRUCTIONS\nNot all attacks and remediation actions will be used.\n\nIf at any time you would like to bring back the initial state of the simulation, please click the Reset Sim button.",
                attackOptions: ["", "Botnet", "RAT", "Logic Bomb", "Backdoor", "Virus", "Spyware", "Worm", "Adware", "Ransomware", "Keylogger", "Phishing"],
                remediationOptions: ["", "Enable DDoS protection", "Patch vulnerable systems", "Disable vulnerable services", "Change the default system password", "Update the cryptographic algorithms", "Change the default application password", "Implement 2FA using push notification", "Conduct a code review", "Implement application fuzzing", "Implement a host-based IPS", "Disable remote access services"],
                questions: [
                    { desc: "An attacker sends multiple SYN packets from multiple sources.", target: "Web server" },
                    { desc: "The attack establishes a connection, which allows remote commands to be executed.", target: "User" },
                    { desc: "The attack is self propagating and compromises a SQL database using well-known credentials as it moves through the network.", target: "Database server" },
                    { desc: "The attacker uses hardware to remotely monitor a user's input activity to harvest credentials.", target: "Executive" },
                    { desc: "The attacker embeds hidden access in an internally developed application that bypasses account login.", target: "Application" }
                ],
                correctAnswers: [
                    { attack: 'Botnet', remediation: 'Enable DDoS protection' },
                    { attack: 'RAT', remediation: 'Disable remote access services' },
                    { attack: 'Worm', remediation: 'Change the default application password' },
                    { attack: 'Keylogger', remediation: 'Implement 2FA using push notification' },
                    { attack: 'Backdoor', remediation: 'Conduct a code review' }
                ]
            },
            setup: function() {
                const container = document.getElementById('sim4-questions-container');
                let questionsHtml = `
                    <div class="sim4-question-grid sim4-header-grid">
                        <span>Attack Description</span>
                        <span>Target</span>
                        <span>Attack Identified</span>
                        <span>BEST Preventative or Remediation Action</span>
                    </div>`;
                this.data.questions.forEach((q, i) => {
                    questionsHtml += `
                        <div class="sim4-question-grid">
                            <span>${q.desc}</span>
                            <span>${q.target}</span>
                            <span><select id="attack-${i}">${this.data.attackOptions.map(o => `<option value="${o}">${o}</option>`).join('')}</select></span>
                            <span><select id="remediation-${i}">${this.data.remediationOptions.map(o => `<option value="${o}">${o}</option>`).join('')}</select></span>
                        </div>`;
                });
                container.innerHTML = questionsHtml;
            },
            check: function() {
                let allCorrect = true;
                for (let i = 0; i < 5; i++) {
                    const selectedAttack = document.getElementById(`attack-${i}`).value;
                    const selectedRemediation = document.getElementById(`remediation-${i}`).value;
                    const correctAnswer = this.data.correctAnswers[i];

                    if (selectedAttack !== correctAnswer.attack || selectedRemediation !== correctAnswer.remediation) {
                        allCorrect = false;
                        break;
                    }
                }
                showModal(allCorrect ? "Correct!" : "Incorrect. Please review your selections.");
            }
        };

        // Initialize the simulation when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            sim4.setup();
            document.getElementById('checkBtn').addEventListener('click', () => sim4.check());
            document.getElementById('resetBtn').addEventListener('click', () => sim4.setup());
            document.getElementById('infoBtn').onclick = () => {
                showModal(sim4.data.info, false);
            };
        });
    </script>
</body>
</html>
