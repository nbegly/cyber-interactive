<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sim 16: Password Policy & Forensics</title>
    <link rel="stylesheet" href="../../../assets/style.css">
    <style>
        .sim-top-bar {
            display: flex;
            justify-content: space-between; 
            align-items: center;
            margin-bottom: 1rem;
        }

        #infoModal .modal-body {
            white-space: pre-wrap; 
            line-height: 1.6;  
        }

        .info-btn {
            padding: 8px;
            background-color: var(--interactive-blue);
            border: none;
            border-radius: 5px;
            cursor: pointer;
            color: white;
            line-height: 0;
        }

        .info-btn:hover {
            background-color: var(--interactive-blue-hover);
        }

        .info-btn svg {
            width: 24px;
            height: 24px;
            fill: currentColor;
        }
        .sim-container {
            width: 100%;
            max-width: 900px;
            background-color: var(--bg-dark-secondary);
            padding: 20px;
            border-radius: 8px;
        }
        .sim-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            align-items: center;
        }
        .evidence-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            justify-items: center;
        }
        .evidence-item {
            cursor: pointer;
            text-align: center;
            transition: transform 0.2s;
            width: 150px;
        }
        .evidence-item:hover {
            transform: translateY(-5px);
        }
        .evidence-icon {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background-color: var(--bg-dark-main);
            border: 3px solid var(--accent-green);
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0 auto 10px;
        }
        .evidence-icon svg {
            width: 60px;
            height: 60px;
            fill: var(--accent-green);
        }
        .evidence-item span {
            font-weight: 600;
        }
        .evidence-item.full-width {
            grid-column: 1 / -1; 
        }
        .answer-area {
            background-color: var(--bg-dark-main);
            padding: 20px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }
        .answer-group {
            margin-bottom: 25px;
        }
        .answer-group h4 {
            margin-top: 0;
            color: var(--accent-green);
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
        }
        .checkbox-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        .answer-group label {
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); justify-content: center; align-items: center; }
        .modal-content { background-color: var(--bg-dark-secondary); border: 1px solid var(--accent-green); border-radius: 8px; width: 90%; max-width: 600px; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; padding: 10px 15px; background-color: #3c3c3c; border-bottom: 1px solid var(--accent-green); }
        .modal-header h5 { margin: 0; color: var(--accent-green); }
        .modal-close { background: none; border: none; font-size: 1.5em; color: var(--text-dark); cursor: pointer; }
        .modal-body { padding: 20px; white-space: pre-wrap; }
        .modal-body table { width: 100%; border-collapse: collapse; }
        .modal-body th, .modal-body td { padding: 8px; text-align: left; border-bottom: 1px solid var(--border-color); }
        .modal-body th { color: var(--accent-green); }

    </style>
</head>
<body>
    <div class="sim-container">
        <div class="sim-top-bar">
            <a href="../index.html" class="back-btn sim-btn">Back to Menu</a>
            <button id="infoBtn" class="info-btn" title="Show Instructions">
            <svg viewBox="0 0 24 24"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg></button>
        </div>
        <h3>Sim 16: Password Policy & Forensics</h3>
        <div class="sim-grid">
            <div class="evidence-container">
                <div class="evidence-item" data-modal="directory">
                    <div class="evidence-icon"><svg viewBox="0 0 24 24"><path d="M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"/></svg></div>
                    <span>Directory contents</span>
                </div>
                <div class="evidence-item" data-modal="compensation">
                    <div class="evidence-icon"><svg viewBox="0 0 24 24"><path d="M18 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 4h5v8l-2.5-1.5L6 12V4z"/></svg></div>
                    <span>Compensation report</span>
                </div>
                <div class="evidence-item full-width" data-modal="userData">
                    <div class="evidence-icon"><svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg></div>
                    <span>User data</span>
                </div>
            </div>

            <div class="answer-area">
                <div class="answer-group">
                    <h4>Identify weak password practices: (select all that apply)</h4>
                    <div class="checkbox-grid">
                        <label><input type="checkbox" name="weakness" value="Age"> Age</label>
                        <label><input type="checkbox" name="weakness" value="Expiration"> Expiration</label>
                        <label><input type="checkbox" name="weakness" value="Reuse"> Reuse</label>
                        <label><input type="checkbox" name="weakness" value="Complexity"> Complexity</label>
                        <label><input type="checkbox" name="weakness" value="Length"> Length</label>
                    </div>
                </div>
                <div class="answer-group">
                    <h4>Select the containment step that will leave potential evidence on the host uncompromised:</h4>
                    <div>
                        <label><input type="radio" name="containment" value="PIN code"> PIN code</label>
                        <label><input type="radio" name="containment" value="OTP token"> OTP token</label>
                        <label><input type="radio" name="containment" value="SMS authentication"> SMS authentication</label>
                        <label><input type="radio" name="containment" value="FIDO security key"> FIDO security key</label>
                    </div>
                </div>
            </div>
        </div>
        <div class="sim-controls">
            <div>
                <button class="sim-check-btn" id="checkBtn">Check Answer</button>
                <button class="sim-reset-btn" id="resetBtn">Reset Sim</button>
            </div>
        </div>
    </div>

    <div id="directory" class="modal"><div class="modal-content"><div class="modal-body"></div></div></div>
    <div id="compensation" class="modal"><div class="modal-content"><div class="modal-body"></div></div></div>
    <div id="userData" class="modal"><div class="modal-content"><div class="modal-body"></div></div></div>
    <div id="infoModal" class="modal"><div class="modal-content"><div class="modal-body"></div></div></div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const simData = {
                modals: {
                    info: `Situation:
A security audit has revealed several potential weaknesses in the organization's user authentication policies. An analyst is reviewing internal documents to identify policy gaps. Additionally, during a live incident response, the analyst must choose a containment method that preserves forensic evidence on a compromised host.

Instructions:
1. Review the provided documents by clicking on each icon.
2. Based on the "User data" document, identify all the weak password practices currently allowed by the system.
3. Select the single containment step that is least likely to alter the state of the compromised host's operating system or file system.`,
                    directory: `Directory: /etc/security
Owner: root
Permissions: rwxr-x---

Contents:
- access.conf (Defines login access rules)
- limits.conf (Sets user resource limits)
- pam.d/ (Pluggable Authentication Modules configuration)
- pwquality.conf (Password quality checks - NOT CURRENTLY ENFORCED)`,
                    compensation: `Compensation Report:
Analyst: J. Doe
Date: 2025-09-05

Finding: The current identity and access management (IAM) system is a legacy platform scheduled for decommissioning in Q4.

Observation: The system lacks modern input validation for password creation. All password policy enforcement, except for reuse, must be handled by a planned external module.

Recommendation: Fast-track the deployment of the new IAM solution with multi-factor authentication (MFA) to mitigate risks associated with weak password policies.`,
                    userData: `<table>
                        <thead><tr><th>Username</th><th>Password</th><th>IP address (last login)</th><th>Last active</th><th>Last password change</th></tr></thead>
                        <tbody>
                            <tr><td>finance</td><td>money2023</td><td>10.0.20.18</td><td>4/3/2023</td><td>5/8/2023</td></tr>
                            <tr><td>adam</td><td>soccerStar</td><td>145.24.0.15</td><td>4/1/2023</td><td>8/4/2016</td></tr>
                            <tr><td>april</td><td>baxter</td><td>20.55.0.28</td><td>4/2/2023</td><td>6/6/2020</td></tr>
                            <tr><td>caroline</td><td>Summer2012</td><td>18.6.0.4</td><td>4/3/2023</td><td>5/8/2012</td></tr>
                            <tr><td>joe</td><td>pword</td><td>147.0.20.45</td><td>1/7/2018</td><td>11/5/2014</td></tr>
                            <tr><td>payroll</td><td>payroll2015</td><td>10.0.20.18</td><td>4/3/2023</td><td>5/8/2015</td></tr>
                            <tr><td>sam</td><td>TW#$RTok4</td><td>140.0.28.15</td><td>4/3/2023</td><td>3/1/2023</td></tr>
                            <tr><td>walter</td><td>Hotdog</td><td>16.0.80.45</td><td>9/10/2022</td><td>6/5/2020</td></tr>
                            <tr><td>zDomainAdmin</td><td>SuperUser</td><td>10.0.20.18</td><td>4/3/2023</td><td>1/5/2013</td></tr>
                        </tbody>
                    </table>`
                },
                correctAnswers: {
                    weaknesses: ["Age", "Reuse", "Length", "Complexity"],
                    containment: "FIDO security key"
                }
            };

function openModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
        const modalBody = modal.querySelector('.modal-body');
        
        let content;
        if (modalId === 'infoModal') {
            content = simData.modals.info; 
        } else {
            content = simData.modals[modalId];
        }

        if (modalId === 'userData') {
            modalBody.innerHTML = content;
        } else {
            modalBody.textContent = content;
        }
        
        modal.style.display = 'flex';
    }
}

            document.querySelectorAll('.evidence-item').forEach(item => {
                item.addEventListener('click', () => openModal(item.dataset.modal));
            });

            document.getElementById('infoBtn').addEventListener('click', () => openModal('infoModal'));
            
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', e => {
                    if (e.target === modal || e.target.classList.contains('modal-close')) {
                        modal.style.display = 'none';
                    }
                });
            });

            document.getElementById('resetBtn').addEventListener('click', () => {
                document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
                document.querySelectorAll('input[type="radio"]').forEach(rb => rb.checked = false);
            });

            document.getElementById('checkBtn').addEventListener('click', () => {
                const selectedWeaknesses = Array.from(document.querySelectorAll('input[name="weakness"]:checked')).map(cb => cb.value).sort();
                const selectedContainment = document.querySelector('input[name="containment"]:checked')?.value;

                const correctWeaknesses = simData.correctAnswers.weaknesses.sort();

                const weaknessesCorrect = selectedWeaknesses.length === correctWeaknesses.length && selectedWeaknesses.every((val, index) => val === correctWeaknesses[index]);
                const containmentCorrect = selectedContainment === simData.correctAnswers.containment;

                if (weaknessesCorrect && containmentCorrect) {
                    alert("Correct! You have identified all weak password practices and the appropriate containment step.");
                } else {
                    let feedback = "Incorrect. Please review your selections.\n\n";
                    feedback += `Weak Password Practices: ${weaknessesCorrect ? 'Correct' : 'Incorrect'}\n`;
                    feedback += `Containment Step: ${containmentCorrect ? 'Correct' : 'Incorrect'}`;
                    alert(feedback);
                }
            });
        });
    </script>
</body>
</html>
