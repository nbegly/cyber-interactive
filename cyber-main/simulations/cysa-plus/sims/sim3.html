<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Incident Simulation</title>
    <link rel="stylesheet" href="../../../assets/style.css">
    <style>
        .sim-container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: var(--bg-dark-secondary);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid var(--border-color);
        }

        .sim-top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .info-btn {
            background-color: var(--interactive-blue);
            color: white;
            padding: 8px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
        }

        .info-btn:hover {
            background-color: var(--interactive-blue-hover);
        }

        .info-btn svg {
            width: 24px;
            height: 24px;
            fill: white;
        }

        .evidence-bar {
            display: flex;
            justify-content: space-around;
            text-align: center;
            padding: 20px;
            background-color: var(--bg-dark-main);
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
        }

        .evidence-item {
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            transition: transform 0.2s;
            background: none;
            border: none;
            color: var(--text-light);
            font-size: 1rem;
            padding: 0;
        }

        .evidence-item:hover {
            transform: translateY(-2px);
        }

        .evidence-icon {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background-color: var(--bg-dark-secondary);
            border: 3px solid var(--accent-green);
            display: flex;
            justify-content: center;
            align-items: center;
            transition: transform 0.2s, background-color 0.2s;
        }

        .evidence-item:hover .evidence-icon {
            transform: scale(1.1);
            background-color: var(--accent-green);
        }
        
        .evidence-item:hover .evidence-icon svg {
             fill: white;
        }

        .evidence-icon svg {
            width: 40px;
            height: 40px;
            fill: var(--accent-green);
            transition: fill 0.2s;
        }

        .answer-area {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .answer-box {
            background-color: var(--bg-dark-main);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
        }

        .answer-box h4 {
            margin-top: 0;
            text-align: center;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
            margin-bottom: 20px;
            color: white;
        }

        .form-group {
            display: grid;
            grid-template-columns: 1fr 1.5fr;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .kill-chain-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px 20px;
        }

        select {
            background-color: var(--bg-dark-secondary);
            color: white;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 8px 12px;
            font-size: 14px;
            width: 100%;
        }

        select:focus {
            outline: none;
            border-color: var(--accent-green);
        }
        
        /* Highlighting Logic from new version, adapted for old class names */
        .form-group.correct-answer select {
            border: 2px solid var(--accent-green);
            box-shadow: 0 0 8px var(--accent-green);
        }
        
        .form-group.incorrect-answer select {
            border: 2px solid var(--danger-red);
            box-shadow: 0 0 8px var(--danger-red);
        }

        .sim-controls {
            display: flex;
            justify-content: flex-end;
            margin-top: 20px;
            gap: 10px;
        }

        .modal {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            display: none; justify-content: center; align-items: center;
            z-index: 1050; padding: 20px; box-sizing: border-box;
        }
        
        .modal.active {
            display: flex;
        }

        .modal-content {
            background-color: var(--bg-dark-secondary); padding: 30px;
            border-radius: 10px; max-width: 95%; max-height: 95vh;
            width: 800px; text-align: left;
            border: 1px solid var(--border-color); overflow: auto;
            position: relative;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        
        .modal-content.centered-text { text-align: center; }
        
        .modal-close-btn {
            position: absolute; top: 15px; right: 15px;
            background: none; border: none;
            color: var(--text-muted); font-size: 2rem;
            line-height: 1; cursor: pointer; transition: color 0.2s;
        }
        .modal-close-btn:hover { color: var(--text-light); }
        
        .modal-confirm-btn {
            display: block; margin: 20px auto 0 auto;
            padding: 10px 30px; background-color: var(--accent-green);
            color: white; border: none; border-radius: 5px; cursor: pointer;
        }

        pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            font-family: 'Courier New', Courier, monospace;
            background-color: var(--bg-dark-main);
            padding: 15px; border-radius: 5px;
            border: 1px solid var(--border-color);
        }

        .log-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
    font-size: 14px;
}

.log-table th, .log-table td {
    border: 1px solid var(--border-color);
    padding: 12px 15px;
    text-align: left;
}

.log-table thead {
    background-color: var(--interactive-blue);
    color: var(--text-light);
    font-weight: 600;
}

.log-table tbody tr {
    background-color: var(--bg-dark-tertiary);
}

.log-table tbody tr:nth-of-type(even) {
    background-color: var(--bg-dark-secondary);
}

.high-scan-table {
    width: 100%;
    table-layout: fixed;
    border: none;
    border-collapse: collapse;
    margin-bottom: 25px;
}

.high-scan-table tbody td {
    border: none;
    padding: 10px 8px !important;
    border-collapse: collapse;
}

.high-scan-table th {
    color: red;

}

.med-scan-table {
    width: 100%;
    table-layout: fixed;
    border: none;
    border-collapse: collapse;
    margin-bottom: 25px;
}

.med-scan-table tbody td {
    border: none;
    padding: 10px 8px !important;
    border-collapse: collapse;
}

.med-scan-table th {
    color: rgb(155, 76, 12);
}

.low-scan-table {
    width: 100%;
    table-layout: fixed;
    border: none;
    border-collapse: collapse;
    margin-bottom: 25px;
}

.low-scan-table tbody td {
    border: none;
    padding: 10px 8px !important;
    border-collapse: collapse;
}

.low-scan-table th {
    color: rgb(0, 47, 255);
}

    </style>
</head>
<body>

    <div class="sim-container">
        <div class="sim-top-bar">
            <a href="../index.html" class="back-btn">Back to CySA+ Menu</a>
            <button id="infoBtn" class="info-btn" title="Show Instructions">
                <svg viewBox="0 0 24 24"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </button>
        </div>

             <h3>Sim 3: Security Incident Analysis</h3>

        <div class="evidence-bar">
            <button class="evidence-item" data-modal-target="#phishingEmailModal">
                <div class="evidence-icon"><svg viewBox="0 0 24 24"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg></div>
                <span>Phishing email</span>
            </button>
            <button class="evidence-item" data-modal-target="#firewallLogModal">
                <div class="evidence-icon"><svg viewBox="0 0 24 24"><path d="M12 2L2 7v5.2c0 5.4 4.3 10 10 10s10-4.6 10-10V7L12 2zm0 17c-4.4 0-8-3.6-8-8V8.7l8-3.7 8 3.7V11c0 4.4-3.6 8-8 8z"/></svg></div>
                <span>Firewall log</span>
            </button>
            <button class="evidence-item" data-modal-target="#fimModal">
                <div class="evidence-icon"><svg viewBox="0 0 24 24"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg></div>
                <span>File Integrity Report</span>
            </button>
            <button class="evidence-item" data-modal-target="#malwareDomainModal">
                <div class="evidence-icon"><svg viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"/></svg></div>
                <span>Malware Domain List</span>
            </button>
            <button class="evidence-item" data-modal-target="#vulnerabilityModal">
                <div class="evidence-icon"><svg viewBox="0 0 24 24"><path d="M19.48 8.28l-2.22-4.44c-.2-.4-.6-.64-1.06-.64H7.8c-.46 0-.86.24-1.06.64L4.52 8.28c-1.48.74-2.52 2.26-2.52 4C2 14.43 3.57 16 5.5 16h13c1.93 0 3.5-1.57 3.5-3.72 0-1.74-1.04-3.26-2.52-4zM9 13H7v-2h2v2zm4 0h-2v-2h2v2zm4 0h-2v-2h2v2z"/></svg></div>
                <span>Vulnerability Scan</span>
            </button>
        </div>

        <div class="answer-area">
            <div class="answer-box">
                <h4>Identify the following:</h4>
                <div class="form-group"><label>Malicious executable</label><select id="malicious-executable"><option>Select option</option><option>invoice.exe</option><option>payroll.xlsx</option><option>resume1.docx</option><option>resume2.docx</option></select></div>
                <div class="form-group"><label>Malicious IP address</label><select id="malicious-ip"><option>Select option</option><option>10.1.1.238</option><option>81.161.63.253</option><option>171.25.193.20</option><option>171.25.193.25</option><option>185.220.101.194</option><option>192.168.2.1</option></select></div>
                <div class="form-group"><label>Date/time malware entered</label><select id="malware-time"><option>Select option</option><option>1 Dec 2019 11:24:16</option><option>1 Dec 2019 14:03:55</option><option>30 Nov 2019 12:05:34</option><option>1 Dec 2019 14:25:30</option><option>1 Dec 2019 13:59:25</option></select></div>
            </div>
            
            <div class="answer-box">
                <h4>Kill chain item</h4>
                <div class="kill-chain-grid">
                    <div class="form-group"><label>Phishing email</label><select id="ctrl-phishing"><option>Select control</option><option>DNS sinkhole</option><option>MAC filtering</option><option>Backups</option><option>Restricted local user permissions</option><option>Network segmentation</option><option>Email filtering</option><option>Firewall file type filter</option><option>Plain text email format</option><option>VPN</option><option>Disk-level encryption</option><option>Updated antivirus</option><option>Honeypot</option></select></div>
                    <div class="form-group"><label>Malware execution</label><select id="ctrl-execution"><option>Select control</option><option>DNS sinkhole</option><option>MAC filtering</option><option>Backups</option><option>Restricted local user permissions</option><option>Network segmentation</option><option>Email filtering</option><option>Firewall file type filter</option><option>Plain text email format</option><option>VPN</option><option>Disk-level encryption</option><option>Updated antivirus</option><option>Honeypot</option></select></div>
                    <div class="form-group"><label>Active links</label><select id="ctrl-links"><option>Select control</option><option>DNS sinkhole</option><option>MAC filtering</option><option>Backups</option><option>Restricted local user permissions</option><option>Network segmentation</option><option>Email filtering</option><option>Firewall file type filter</option><option>Plain text email format</option><option>VPN</option><option>Disk-level encryption</option><option>Updated antivirus</option><option>Honeypot</option></select></div>
                    <div class="form-group"><label>Malware install</label><select id="ctrl-install"><option>Select control</option><option>DNS sinkhole</option><option>MAC filtering</option><option>Backups</option><option>Restricted local user permissions</option><option>Network segmentation</option><option>Email filtering</option><option>Firewall file type filter</option><option>Plain text email format</option><option>VPN</option><option>Disk-level encryption</option><option>Updated antivirus</option><option>Honeypot</option></select></div>
                    <div class="form-group"><label>Malicious website access</label><select id="ctrl-website"><option>Select control</option><option>DNS sinkhole</option><option>MAC filtering</option><option>Backups</option><option>Restricted local user permissions</option><option>Network segmentation</option><option>Email filtering</option><option>Firewall file type filter</option><option>Plain text email format</option><option>VPN</option><option>Disk-level encryption</option><option>Updated antivirus</option><option>Honeypot</option></select></div>
                    <div class="form-group"><label>Malware download</label><select id="ctrl-download"><option>Select control</option><option>DNS sinkhole</option><option>MAC filtering</option><option>Backups</option><option>Restricted local user permissions</option><option>Network segmentation</option><option>Email filtering</option><option>Firewall file type filter</option><option>Plain text email format</option><option>VPN</option><option>Disk-level encryption</option><option>Updated antivirus</option><option>Honeypot</option></select></div>
                </div>
            </div>
        </div>

        <div class="sim-controls">
            <button class="sim-check-btn" id="checkBtn">Check Answers</button>
            <button class="sim-reset-btn" id="resetBtn">Reset Sim</button>
        </div>
    </div>

    <div class="modal" id="instructionsModal"><div class="modal-content"><button class="modal-close-btn">&times;</button><h2>Instructions</h2><p>A company recently experienced a security incident. The security team has determined a user clicked on a link embedded in a phishing email that was sent to the entire company. The link resulted in a malware download, which was subsequently installed and run.</p><h4>Part 1</h4><p>Review the artifacts associated with the security incident. Identify the name of the malware, the malicious IP address, and the date and time when the malware executable entered the organization.</p><h4>Part 2</h4><p>Review the kill chain items and select an appropriate control for each that would improve the security posture of the organization and would have helped to prevent this incident from occurring. Each control may only be used once, and not all controls will be used.</p></div></div>
    <div class="modal" id="phishingEmailModal"><div class="modal-content"><button class="modal-close-btn">&times;</button>From: IT HelpDesk <it-helpdesk@company.com><p></pp>
Sent: Sun 12/01/2019 2:00:00<p></pp>
To: Global Users <globalusers@company.com><p></pp>
Subject: Moving our mail servers<p></pp>

Hi,<p></pp><p></pp>

In the upcoming days, we will be moving our mail servers. Check out the new Company Webmail to know if it has started working for you.<p></pp>

Visit the new Company Webmail to see all the new features.
Use your current username and password at Company Webmail.<p></pp>

Download the latest mail client located here.<p></pp>

Thank you.<p></pp>

IT HelpDesk</div></div>
    <div class="modal" id="firewallLogModal"><div class="modal-content"><button class="modal-close-btn">&times;</button><pre>Traffic denied:

Dec 1 14:10:46 fire00: NetScreen device_id=fire00 [Root]system-notification-00257(traffic): policy_id=119 service=udp/port:7001 proto=17 src zone=Trust dst zone=Untrust action=Deny sent=0 rcvd=0 src=192.168.2.1 dst=1.2.3.4 src_port=3036 dst_port=7001
Dec 1 14:12:31 fire00 aka1: NetScreen device_id=aka1 [Root]system-notification-00257(traffic): policy_id=120 service=udp/port:20721 proto=17 src zone=Trust dst zone=DMZ action=Deny sent=0 rcvd=0 src=192.168.2.2 dst=1.2.3.4 src_port=53 dst_port=20721
Dec 1 14:14:31 fire00 aka1: NetScreen device_id=aka1 [Root]system-notification-00257(traffic): policy_id=120 service=udp/port:17210 proto=17 src zone=Trust dst zone=DMZ action=Deny sent=0 rcvd=0 src=192.168.2.2 dst=1.2.3.4 src_port=53 dst_port=17210

Alert messages:

Dec 1 14:03:19 [xx] ns5gt: NetScreen device_id=ns5gt [Root]system-alert-00016: Invoice.exe From 81.161.63.253, proto TCP (Zone Untrust, int Untrust). Occurred 1 times.

Critical messages:

Dec 1 11:24:16 fire00 sav00: NetScreen device_id=sav00 [Root]system-critical-00436: Large ICMP packet! From 1.2.3.4 to 2.3.4.5, proto 1 (zone Untrust, int ethernet1/2). Occurred 1 times.
[00001] 2005-05-16 12:55:10 [Root]system-critical-00042: Replay packet detected on IPSec tunnel on ethernet3 with tunnel ID 0x1c! From z.y.x.w to a.b.c.d/336, ESP, SPI 0xf63af637, SEQ 0xe337.
[00001] 2006-05-25 13:34:33 [Root]system-alert-00008: IP spoofing! From 10.1.1.238:80 to a.b.c.d:49807, proto TCP (zone Untrust, int ethernet3). Occurred 1 times.

</pre></div></div>
    <div class="modal" id="fimModal"><div class="modal-content"><button class="modal-close-btn">&times;</button>
<table class="log-table">
    <thead>
        <tr>
            <th>Action</th>
            <th>Object type</th>
            <th>What</th>
            <th>Who</th>
            <th>When</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><strong>Added</strong><p></p>Where:<p>Workstation:</td>
            <td>File<p></p>Host1<p>(172.30.0.152)</td>
            <td>\\host1\users\user1\Downloads\payroll.xlsx</td>
            <td>Domainusers\user1</td>
            <td>11/30/19 12:05:34</td>
        </tr>
        <tr>
            <td><strong>Removed</strong><p></p>Where:<p>Workstation:<br></br><br></br>Date created:</td>
            <td>File<p>Host1<p>(172.30.0.152)<br></br><br></br></td>
            <td>\\host1\users\user1\Downloads\payroll.xlsx<br></br><br></br><br></br> "11/30/19 12:05:34"</td>
            <td>Domainusers\user1</td>
            <td>11/30/19 12:25:13</td>
        </tr>
        <tr>
            <td><strong>Added</strong><p></p>Where:<p>Workstation:</td>
            <td>File<p></p>Host1<p>(172.30.0.152)</td>
            <td>\\host1\users\user1\Downloads\resume1.docx</td>
            <td>Domainusers\user1</td>
            <td>12/1/19 13:59:25</td>
        </tr>
        <tr>
            <td><strong>Added</strong><p></p>Where:<p>Workstation:</td>
            <td>File<p></p>Host1<p>(172.30.0.152)</td>
            <td>\\host1\users\user1\Downloads\invoice.exe</td>
            <td>Domainusers\user1</td>
            <td>12/1/19 14:03:55</td>
        </tr>
        <tr>
            <td><strong>Renamed</strong><p></p>Where:<p>Workstation:<br></br>Name changed from:</td>
            <td>File<p></p>Host1<p>(172.30.0.152)<br></br><br></br></td>
            <td><br></br><br></br><br></br>resume1.docx to resume2.docx</td>
            <td>Domainusers\user1</td>
            <td>12/1/19 14:25:30</td>
        </tr>
    </tbody>
</table></div></div>
    <div class="modal" id="malwareDomainModal"><div class="modal-content"><button class="modal-close-btn">&times;</button><pre># MalwareDomainList.com Host List #
# http://www.maowaredomainlist.com/hostlist/hosts.txt #
# Last updated: 3 Dec 2019, 21:00:00 #
# IP #

171.25.193.20
171.25.193.25
185.220.101.194
81.161.63.103
81.161.63.253
77.247.181.162
141.98.81.194
46.101.220.225
139.59.95.60
51.254.37.192
81.161.63.104
139.59.116.115</pre></div></div>
    <div class="modal" id="vulnerabilityModal"><div class="modal-content"><button class="modal-close-btn">&times;</button>
        <table class="high-scan-table">
            <thead>
                <tr>
                    <th style="width: 20%;">HIGH SEVERITY</th>
                    <th></th>
            </thead>
                </tr>
            <tbody>
                <tr>
                    <td><strong>Title:</strong></td>
                    <td>Cleartext transmission of sensitive information</td>
                </tr>
                <tr>
                    <td><strong>Description:</strong></td>
                    <td>The software transmits sensitive or security-critical data in Cleartext in a communication channel that can be sniffed by authorized users</td>
                </tr>
                <tr>
                    <td><strong>Affected asset:</strong></td>
                    <td>172.30.0.150</td>
                </tr>
                <tr>
                    <td><strong>Risk:</strong></td>
                    <td>Anyone can read the information by gaining access to the channel being used for communication</td>
                </tr>
                <tr>
                    <td><strong>Reference:</strong></td>
                    <td>CVE-2002-1949</td>
                </tr>
            </tbody>
        </table>
        
        <table class="high-scan-table">
            <thead>
                <tr>
                    <th style="width: 20%;">HIGH SEVERITY</th>
                    <th></th>
            </thead>
                </tr>
            <tbody>
                <tr>
                    <td><strong>Title:</strong></td>
                    <td>Elevated privileges not required for software installations</td>
                </tr>
                <tr>
                    <td><strong>Description:</strong></td>
                    <td>All account types can install software, requirements for privileged accounts for installation capabilities is not configured</td>
                </tr>
                <tr>
                    <td><strong>Affected asset:</strong></td>
                    <td>172.30.0.152</td>
                </tr>
                <tr>
                    <td><strong>Risk:</strong></td>
                    <td>Enhanced risk for unauthorized or malicious software installation</td>
                </tr>
                <tr>
                    <td><strong>Reference:</strong></td>
                    <td>n/a</td>
                </tr>
            </tbody>
        </table>

        <table class="med-scan-table">
            <thead2>
                <tr>
                    <th style="width: 20%;">MEDIUM SEVERITY</th>
                    <th></th>
            </thead2>
                </tr>
            <tbody>
                <tr>
                    <td><strong>Title:</strong></td>
                    <td>Sensitive cookie in HTTPS session without "secure" attribute</td>
                </tr>
                <tr>
                    <td><strong>Description:</strong></td>
                    <td>The secure attribute for sensitive cookies in HTTPS sessions is not set, which could cause the user agent to send those cookies in plaintext over HTTP session</td>
                </tr>
                <tr>
                    <td><strong>Affected asset:</strong></td>
                    <td>172.30.0.157</td>
                </tr>
                <tr>
                    <td><strong>Risk:</strong></td>
                    <td> Session sidejacking</td>
                </tr>
                <tr>
                    <td><strong>Reference:</strong></td>
                    <td>CVE-2004-0462</td>
                </tr>
            </tbody>
        </table>

        <table class="low-scan-table">
            <thead3>
                <tr>
                    <th style="width: 20%;">LOW SEVERITY</th>
                    <th></th>
            </thead3>
                </tr>
            <tbody>
                <tr>
                    <td><strong>Title:</strong></td>
                    <td>Untrusted SSL/TLS Server X.509 certificate</td>
                </tr>
                <tr>
                    <td><strong>Description:</strong></td>
                    <td>The server's TLS/SSL certificate is signed by a certificate authority that is untrusted or unknown</td>
                </tr>
                <tr>
                    <td><strong>Affected asset:</strong></td>
                    <td>172.30.0.153</td>
                </tr>
                <tr>
                    <td><strong>Risk:</strong></td>
                    <td>May allow on-path attackers to insert a spoofed certificate for any distinguished name (DN)</td>
                </tr>
                <tr>
                    <td><strong>Reference:</strong></td>
                    <td>CVE-2005-1234</td>
                </tr>
            </tbody>
        </table>
    </div>
    </div>
    <div class="modal" id="resultsModal"><div class="modal-content centered-text"><h2 id="resultsTitle"></h2><p id="resultsText"></p><button class="modal-confirm-btn" id="resultsConfirmBtn">OK</button></div></div>

<script>
document.addEventListener('DOMContentLoaded', () => {

    // --- MODAL HANDLING ---
    const openModalTriggers = document.querySelectorAll('[data-modal-target], #infoBtn');
    const closeModalTriggers = document.querySelectorAll('.modal-close-btn, .modal-confirm-btn');
    
    // Special handling for the info button which doesn't follow the pattern
    document.getElementById('infoBtn').addEventListener('click', () => {
        document.getElementById('instructionsModal').classList.add('active');
    });

    document.querySelectorAll('.evidence-item').forEach(trigger => {
        trigger.addEventListener('click', () => {
            const modal = document.querySelector(trigger.dataset.modalTarget);
            if (modal) modal.classList.add('active');
        });
    });

    closeModalTriggers.forEach(trigger => {
        trigger.addEventListener('click', () => {
            trigger.closest('.modal').classList.remove('active');
        });
    });
    
    window.addEventListener('click', e => {
        if (e.target.classList.contains('modal')) {
            e.target.classList.remove('active');
        }
    });

    // --- SIMULATION LOGIC ---
    const checkBtn = document.getElementById('checkBtn');
    const resetBtn = document.getElementById('resetBtn');
    const formGroups = document.querySelectorAll('.form-group');
    const allSelects = document.querySelectorAll('select');
    
    const resultsModal = document.getElementById('resultsModal');
    const resultsTitle = document.getElementById('resultsTitle');
    const resultsText = document.getElementById('resultsText');

    const correctAnswers = {
        'malicious-executable': 'invoice.exe',
        'malicious-ip': '81.161.63.253',
        'malware-time': '1 Dec 2019 14:03:55',
        'ctrl-phishing': 'Email filtering',
        'ctrl-links': 'Plain text email format',
        'ctrl-website': 'DNS sinkhole',
        'ctrl-execution': 'Updated antivirus',
        'ctrl-install': 'Restricted local user permissions',
        'ctrl-download': 'Firewall file type filter'
    };
    
    function removeHighlighting() {
        formGroups.forEach(group => {
            group.classList.remove('correct-answer', 'incorrect-answer');
        });
    }

    function resetSimulation() {
        allSelects.forEach(select => {
            select.selectedIndex = 0;
        });
        removeHighlighting();
    }

    function checkAnswers() {
        removeHighlighting();
        let incorrectCount = 0;

        for (const selectId in correctAnswers) {
            const selectElement = document.getElementById(selectId);
            const selectedValue = selectElement.value;
            const correctAnswer = correctAnswers[selectId];
            const groupElement = selectElement.closest('.form-group');
            
            if (selectedValue === correctAnswer) {
                groupElement.classList.add('correct-answer');
            } else {
                groupElement.classList.add('incorrect-answer');
                incorrectCount++;
            }
        }
        
        if (incorrectCount === 0) {
            resultsTitle.textContent = 'All Answers Correct!';
            resultsText.textContent = 'Excellent work. You have successfully analyzed the incident.';
        } else {
            resultsTitle.textContent = 'Incorrect';
            resultsText.textContent = `You have ${incorrectCount} incorrect answers. Review the highlighted items.`;
        }
        
        resultsModal.classList.add('active');
    }

    resetBtn.addEventListener('click', resetSimulation);
    checkBtn.addEventListener('click', checkAnswers);
});
</script>

</body>
</html>